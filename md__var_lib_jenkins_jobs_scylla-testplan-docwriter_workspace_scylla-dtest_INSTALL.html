<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Scylla Tests: Scylla Distributed Tests - Setup Instructions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ScyllaDB Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Scylla Tests
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__var_lib_jenkins_jobs_scylla-testplan-docwriter_workspace_scylla-dtest_INSTALL.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Scylla Distributed Tests - Setup Instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>These are instructions for setting up dtests on a fresh install of Ubuntu Linux 12.04 LTS. If you use something else, you'll need to adapt these for your particular situation (or better yet, append to this file with your platform's requirements and send a pull request.)</p>
<h2>Prerequisite Software:</h2>
<ul>
<li>Update software repositories: <pre class="fragment">  sudo apt-get update
</pre></li>
<li>python <pre class="fragment">  sudo apt-get install python python-setuptools python-dev python-pip
</pre></li>
<li>git <pre class="fragment">  sudo apt-get install git
</pre></li>
<li>windows <pre class="fragment">  python: https://www.python.org/downloads/
  git:https://msysgit.github.io/
  gnuwin32: http://gnuwin32.sourceforge.net/
  apache ant: https://ant.apache.org/bindownload.cgi
</pre></li>
</ul>
<h2>Install Oracle Java 7:</h2>
<ul>
<li>java and misc tools: <pre class="fragment">  sudo apt-get install software-properties-common
  sudo add-apt-repository ppa:webupd8team/java
  sudo apt-get update
  sudo apt-get install oracle-java7-installer

  Windows: http://www.oracle.com/technetwork/java/javase/downloads/index.html
</pre></li>
<li>Ensure that java is a HotSpot 1.7.x version: <pre class="fragment">  # java -version
  java version "1.7.0_40"
  Java(TM) SE Runtime Environment (build 1.7.0_40-b43)
  Java HotSpot(TM) 64-Bit Server VM (build 24.0-b56, mixed mode)
</pre></li>
<li>install ant <pre class="fragment">  sudo apt-get install ant
</pre></li>
</ul>
<h2>Create a git directory for holding several projects we'll use:</h2>
<pre class="fragment">    mkdir -p ~/git/cstar
</pre><h2>Install companion tools / libraries:</h2>
<p>It's best to download the git source tree for these libraries as you will often need to modify them in some fashion at some later point:</p>
<ul>
<li>ccm: <pre class="fragment">  cd ~/git/cstar
  git clone git://github.com/pcmanus/ccm.git
  sudo apt-get install libyaml-dev
  sudo pip install -e ccm
  sudo pip install pyyaml
</pre></li>
<li>python-driver <pre class="fragment">  cd ~/git/cstar
  Cassandra 2.x:
  sudo pip install cassandra-driver
  Cassandra 3.x (requires latest python-driver):
  sudo pip install git+git://github.com/datastax/python-driver@cassandra-test  # install dedicated test branch for new Cassandra features
  sudo pip install --pre cassandra-driver  # fallback driver for new features
  For more instructions on how to install the python-driver,
  see http://datastax.github.io/python-driver/installation.html
</pre></li>
<li>cql <pre class="fragment">  cd ~/git/cstar
  git clone https://code.google.com/a/apache-extras.org/p/cassandra-dbapi2/
  sudo pip install -e cassandra-dbapi2
  This is needed for a few legacy tests, and for cql over thrift
</pre></li>
<li>cassandra-dtest <pre class="fragment">  cd ~/git/cstar
  git clone git://github.com/riptano/cassandra-dtest.git
</pre></li>
<li>nose <pre class="fragment">  sudo apt-get install python-nose
</pre></li>
<li>flaky <pre class="fragment">  sudo pip install flaky
</pre></li>
<li><p class="startli">cassandra </p><pre class="fragment">  cd ~/git/cstar
  git clone http://git-wip-us.apache.org/repos/asf/cassandra.git
  cd cassandra
  ant clean jar
</pre><p class="startli">Optionally, you can self-check cassandra at this point by running it's unit tests: </p><pre class="fragment">   ant test
</pre><p class="startli">Note: you may need to install ant-optional to get junit working: </p><pre class="fragment">   sudo apt-get install ant-optional
</pre></li>
</ul>
<h2>Setup and run dtests</h2>
<ul>
<li>Install current python dependencies: <pre class="fragment">  sudo pip install decorator
</pre></li>
<li>Set CASSANDRA_DIR environment variable. Set the variable in your ~/.bashrc file once so that you don't have to keep setting it everytime you run dtests: <pre class="fragment">  export CASSANDRA_DIR=~/git/cstar/cassandra
</pre></li>
<li>Run the full dtest suite (takes multiple hours, depending on your hardware): <pre class="fragment">   cd ~/git/cstar/cassandra-dtest
   nosetests
</pre></li>
<li>Run the full dtest suite, retrying tests decorated with <code>flaky</code> (see <a href="https://github.com/box/flaky">the `flaky` plugin</a> for more documentation): <pre class="fragment">   cd ~/git/cstar/cassandra-dtest
   nosetests --with-flaky
</pre></li>
<li>Run a single dtest, printing debug info, stopping at the first error encountered (if any): <pre class="fragment">   cd ~/git/cstar/cassandra-dtest
   PRINT_DEBUG=true nosetests -x -s -v putget_test.py
</pre></li>
<li>To reuse cassandra clusters when possible, set the environment variable REUSE_CLUSTER <pre class="fragment">  REUSE_CLUSTER=true nosetests -s -v cql_tests.py</pre> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Feb 14 2017 22:50:43 for Scylla Tests by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
